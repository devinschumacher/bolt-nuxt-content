import{ae as D,q as O,U as S,k as I,T as P,af as x,Q as N,V as E}from"./DRRcpaDw.js";import{i as L}from"./wSbNHcIL.js";function f(e){if(typeof e!="object")return e;var o,i,t=Object.prototype.toString.call(e);if(t==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){i=new e.constructor;for(o in e)e.hasOwnProperty(o)&&i[o]!==e[o]&&(i[o]=f(e[o]))}else{i={};for(o in e)o==="__proto__"?Object.defineProperty(i,o,{value:f(e[o]),configurable:!0,enumerable:!0,writable:!0}):i[o]=f(e[o])}return i}if(t==="[object Array]"){for(o=e.length,i=Array(o);o--;)i[o]=f(e[o]);return i}return t==="[object Set]"?(i=new Set,e.forEach(function(a){i.add(f(a))}),i):t==="[object Map]"?(i=new Map,e.forEach(function(a,n){i.set(f(n),f(a))}),i):t==="[object Date]"?new Date(+e):t==="[object RegExp]"?(i=new RegExp(e.source,e.flags),i.lastIndex=e.lastIndex,i):t==="[object DataView]"?new e.constructor(f(e.buffer)):t==="[object ArrayBuffer]"?e.slice(0):t.slice(-6)==="Array]"?new e.constructor(e):e}function M(e,o){if(typeof e!="string")throw new TypeError("argument str must be a string");const i={},t=o||{},a=t.decode||U;let n=0;for(;n<e.length;){const r=e.indexOf("=",n);if(r===-1)break;let s=e.indexOf(";",n);if(s===-1)s=e.length;else if(s<r){n=e.lastIndexOf(";",r-1)+1;continue}const u=e.slice(n,r).trim();if(t!=null&&t.filter&&!(t!=null&&t.filter(u))){n=s+1;continue}if(i[u]===void 0){let l=e.slice(r+1,s).trim();l.codePointAt(0)===34&&(l=l.slice(1,-1)),i[u]=q(l,a)}n=s+1}return i}function U(e){return e.includes("%")?decodeURIComponent(e):e}function q(e,o){try{return o(e)}catch{return e}}const h=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function C(e,o,i){const t=i||{},a=t.encode||encodeURIComponent;if(typeof a!="function")throw new TypeError("option encode is invalid");if(!h.test(e))throw new TypeError("argument name is invalid");const n=a(o);if(n&&!h.test(n))throw new TypeError("argument val is invalid");let r=e+"="+n;if(t.maxAge!==void 0&&t.maxAge!==null){const s=t.maxAge-0;if(Number.isNaN(s)||!Number.isFinite(s))throw new TypeError("option maxAge is invalid");r+="; Max-Age="+Math.floor(s)}if(t.domain){if(!h.test(t.domain))throw new TypeError("option domain is invalid");r+="; Domain="+t.domain}if(t.path){if(!h.test(t.path))throw new TypeError("option path is invalid");r+="; Path="+t.path}if(t.expires){if(!_(t.expires)||Number.isNaN(t.expires.valueOf()))throw new TypeError("option expires is invalid");r+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(r+="; HttpOnly"),t.secure&&(r+="; Secure"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():t.priority){case"low":{r+="; Priority=Low";break}case"medium":{r+="; Priority=Medium";break}case"high":{r+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:{r+="; SameSite=Strict";break}case"lax":{r+="; SameSite=Lax";break}case"strict":{r+="; SameSite=Strict";break}case"none":{r+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return t.partitioned&&(r+="; Partitioned"),r}function _(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}const V={path:"/",watch:!0,decode:e=>D(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))},y=window.cookieStore;function b(e,o){var l;const i={...V,...o};i.filter??(i.filter=c=>c===e);const t=j(i)||{};let a;i.maxAge!==void 0?a=i.maxAge*1e3:i.expires&&(a=i.expires.getTime()-Date.now());const n=a!==void 0&&a<=0,r=n||t[e]===void 0||t[e]===null,s=f(n?void 0:t[e]??((l=i.default)==null?void 0:l.call(i))),u=a&&!n?H(s,a,i.watch&&i.watch!=="shallow"):O(s);{let c=null;try{!y&&typeof BroadcastChannel<"u"&&(c=new BroadcastChannel(`nuxt:cookies:${e}`))}catch{}const p=(d=!1)=>{!d&&(i.readonly||L(u.value,t[e]))||(F(e,u.value,i),t[e]=f(u.value),c==null||c.postMessage({value:i.encode(u.value)}))},g=d=>{var m;const w=d.refresh?(m=j(i))==null?void 0:m[e]:i.decode(d.value);v=!0,u.value=w,t[e]=f(w),N(()=>{v=!1})};let v=!1;const T=!!P();if(T&&S(()=>{v=!0,p(),c==null||c.close()}),y){const d=w=>{const m=w.changed.find(k=>k.name===e),R=w.deleted.find(k=>k.name===e);m&&g({value:m.value}),R&&g({value:null})};y.addEventListener("change",d),T&&S(()=>y.removeEventListener("change",d))}else c&&(c.onmessage=({data:d})=>g(d));i.watch&&I(u,()=>{v||p()},{deep:i.watch!=="shallow"}),r&&p(r)}return u}function j(e={}){return M(document.cookie,e)}function B(e,o,i={}){return o==null?C(e,o,{...i,maxAge:-1}):C(e,o,i)}function F(e,o,i={}){document.cookie=B(e,o,i)}const A=2147483647;function H(e,o,i){let t,a,n=0;const r=i?O(e):{value:e};return P()&&S(()=>{a==null||a(),clearTimeout(t)}),x((s,u)=>{i&&(a=I(r,u));function l(){n=0,clearTimeout(t);const c=o-n,p=c<A?c:A;t=setTimeout(()=>{if(n+=p,n<o)return l();r.value=void 0,u()},p)}return{get(){return s(),r.value},set(c){l(),r.value=c,u()}}})}const J=()=>({isEnabled:()=>{const t=E().query;return Object.prototype.hasOwnProperty.call(t,"preview")&&!t.preview?!1:!!(t.preview||b("previewToken").value||sessionStorage.getItem("previewToken"))},getPreviewToken:()=>b("previewToken").value||sessionStorage.getItem("previewToken")||void 0,setPreviewToken:t=>{b("previewToken").value=t,E().query.preview=t||"",t?sessionStorage.setItem("previewToken",t):sessionStorage.removeItem("previewToken"),window.location.reload()}});export{J as u};
